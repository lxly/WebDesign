<!DOCTYPE html>
<head>
 <title>test</title>  
 <meta charset="utf-8">
 <style type="text/css">
    #img{
        width: 100px;
        height: 100px;
        margin:30px auto;
        border:3px solid lightgreen;
    }
 </style>
</head>
<body>
<div id="img"></div>
<button>加载图片</button>
<script type="text/javascript" src="../jquery-1.11.3.min.js"></script>
<script type="text/javascript">
    // function getImg(){
    //     var url="http://p1.qhimg.com/t0151320b1d0fc50be8.png?random="+Math.random();
    //     var xmlhttp=window.XMLHttpRequest? new XMLHttpRequest():new ActiveXObject("Microsoft.XMLHttp");
    //     xmlhttp.open("get",url,true);
    //     xmlhttp.onreadystatechange=function(){
    //         if(xmlhttp.readyState==4 && xmlhttp.status==200)
    //         {
    //             var div=document.getElementsByTagName('div')[0];
    //             var img=document.createElement("img");

    //             img.onload=function(){

    //             var width=img.width,height=img.height;           

    //             if(width>height)
    //             {
    //                 img.style.width="100px";
    //                 img.style.height=height;
    //             }
    //             else
    //             {
    //                 img.style.height="100px";
    //                 img.style.width=width;
    //             }
    //             }              
               
    //             img.src=url;
    //             div.appendChild(img);                
    //         }
    //     }
    //     xmlhttp.send();
    // }
    // 
    $(function(){
        $("button").click(function(){
            var url="http://p1.qhimg.com/t0151320b1d0fc50be8.png?random="+Math.random();
            $.get(url,function(){
                var img=$("<img />");
              img.load(function(){
                if (img.width()>img.height()) {
                        img.width(100);
                    }
                    else{
                        img.height(100);
                    }                   
              });                    
            img.attr("src",url);
            $("div").append(img);
            })
        });
        });
</script>
</body>
</html>